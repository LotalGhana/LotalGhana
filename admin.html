<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>LOTAL Admin Panel</title>
  <script src="https://www.gstatic.com/firebasejs/10.5.2/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.5.2/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.5.2/firebase-firestore.js"></script>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <h1>LOTAL GHANA Admin Panel</h1>

  <div id="loginForm">
    <input type="email" id="email" placeholder="Email" />
    <input type="password" id="password" placeholder="Password" />
    <button onclick="login()">Login</button>
  </div>

  <div id="adminArea" style="display:none;">
    <h2>New Blog Post</h2>
    <input type="text" id="title" placeholder="Post Title" />
    <textarea id="content" placeholder="Write your blog content here..."></textarea>
    <button onclick="submitPost()">Submit Post</button>

    <h2>All Posts</h2>
    <ul id="postList"></ul>
  </div>

  <script>
    // Firebase config (use your actual config here)
  const firebaseConfig = {
  apiKey: "AIzaSyARq-cvXbo6y6aWUQwJ-D9vGHukLRCKd7s",
  authDomain: "lotalghanacms.firebaseapp.com",
  projectId: "lotalghanacms",
  storageBucket: "lotalghanacms.firebasestorage.app",
  messagingSenderId: "1059279214193",
  appId: "1:1059279214193:web:a8f10ab98ffb3c90576dd0"
};

    firebase.initializeApp(firebaseConfig);

    const db = firebase.firestore();
    const auth = firebase.auth();

    function login() {
      const email = document.getElementById("email").value;
      const password = document.getElementById("password").value;
      auth.signInWithEmailAndPassword(email, password)
        .then(() => {
          document.getElementById("loginForm").style.display = "none";
          document.getElementById("adminArea").style.display = "block";
          loadPosts();
        })
        .catch(err => alert("Login failed: " + err.message));
    }

    function submitPost() {
      const title = document.getElementById("title").value;
      const content = document.getElementById("content").value;
      const date = new Date();

      db.collection("posts").add({
        title: title,
        content: content,
        createdAt: date.toISOString()
      }).then(() => {
        alert("Post added!");
        document.getElementById("title").value = "";
        document.getElementById("content").value = "";
        loadPosts();
      });
    }

   function loadPosts() {
  db.collection("posts").orderBy("createdAt", "desc").get()
    .then(snapshot => {
      const list = document.getElementById("postList");
      list.innerHTML = "";
      snapshot.forEach(doc => {
        const data = doc.data();
        const id = doc.id;

        const li = document.createElement("li");
        li.innerHTML = `
          <strong>${data.title}</strong>
          <br>
          <small>${new Date(data.createdAt).toLocaleString()}</small>
          <br>
          <button onclick="editPost('${id}', \`${data.title}\`, \`${data.content.replace(/`/g, '\\`')}\`)">Edit</button>
          <button onclick="deletePost('${id}')">Delete</button>
          <hr>
        `;
        list.appendChild(li);
      });
    });
}

function deletePost(postId) {
  if (confirm("Are you sure you want to delete this post?")) {
    db.collection("posts").doc(postId).delete()
      .then(() => {
        alert("Post deleted.");
        loadPosts();
      })
      .catch(error => console.error("Error deleting post:", error));
  }
}

function editPost(postId, oldTitle, oldContent) {
  const newTitle = prompt("Edit title:", oldTitle);
  const newContent = prompt("Edit content:", oldContent);

  if (newTitle && newContent) {
    db.collection("posts").doc(postId).update({
      title: newTitle,
      content: newContent
    }).then(() => {
      alert("Post updated.");
      loadPosts();
    }).catch(err => console.error("Error updating post:", err));
  }
}

  </script>
</body>
</html>
